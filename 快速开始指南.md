# Coze OAuth集成 - 快速开始指南

## 🚀 5分钟快速配置

### 第一步：准备OAuth回调处理

1. **部署Vercel回调处理页面**：
   - 参考 `Vercel部署OAuth回调指南.md` 获取完整部署步骤
   - 或使用我们提供的一键部署模板
   - 获得部署URL，格式如：`https://your-app.vercel.app`

2. **记录回调URL**：
   ```
   https://your-app.vercel.app/oauth/callback
   ```
   这个URL将在下一步配置coze.com时使用。

### 第二步：创建Coze.com OAuth应用

1. **访问Coze.com开发者控制台**：
   - 打开 [https://www.coze.com](https://www.coze.com)
   - 使用Google或GitHub账号登录
   - 点击右上角用户头像 → "Developer Console"
   - 或直接访问：[https://www.coze.com/open/oauth](https://www.coze.com/open/oauth)

2. **创建OAuth应用**：
   - 点击 "Create App" 或 "新建应用"
   - 填写应用基本信息：
     ```yaml
     应用名称: "Coze.cn插件集成"
     应用描述: "用于coze.cn插件调用coze.com工作流API"
     应用类型: "Web Application"
     客户端类型: "Confidential"
     ```

3. **配置OAuth设置**：
   ```yaml
   重定向URI: "https://your-vercel-app.vercel.app/oauth/callback"
   权限范围:
     - "read:user"      # 读取用户信息
     - "read:workspace"  # 读取工作空间
     - "read:workflow"   # 读取工作流
     - "write:workflow"  # 执行工作流
     - "read:chat"       # 读取聊天记录
     - "write:chat"      # 发送消息
   ```

4. **保存应用凭据**：
   - 复制 Client ID
   - 复制 Client Secret
   - ⚠️ Client Secret只显示一次，请妥善保存
   - 详细配置指南请参考：`Coze.com OAuth配置截图指南.md`

### 第三步：测试OAuth配置

1. **运行测试工具**：
   ```bash
   python oauth_test_tool.py
   ```

2. **输入配置**：
   - 粘贴您的 Client ID
   - 粘贴您的 Client Secret

3. **完成授权**：
   - 工具会自动打开浏览器
   - 在Coze.com中点击"授权"
   - 返回测试工具查看结果

### 第四步：集成到插件

1. **使用集成模块**：
   ```python
   from coze_oauth_integration import CozePluginIntegration
   
   # 初始化
   integration = CozePluginIntegration(
       client_id="your_client_id",
       client_secret="your_client_secret",
       redirect_uri="http://localhost:8080/oauth/callback"
   )
   
   # 执行工作流
   result = integration.handle_request({
       "action": "execute_workflow",
       "workflow_id": "your_workflow_id",
       "parameters": {"input": "Hello World"}
   })
   ```

## ✅ 成功标志

测试成功后，您应该看到：
- ✅ OAuth客户端配置完成
- ✅ 浏览器正常打开授权页面
- ✅ 授权后成功获取令牌
- ✅ API调用返回工作流列表

## ❌ 常见问题

### 问题1：找不到开发者控制台
**解决方案**：
- 确认使用 coze.com（不是 coze.cn）
- 尝试直接访问：https://www.coze.com/open/oauth/apps
- 可能需要先申请开发者权限

### 问题2：授权后回调失败
**解决方案**：
- 检查重定向URI是否为：`http://localhost:8080/oauth/callback`
- 确认端口8080未被占用
- 重新运行测试工具

### 问题3：API调用失败
**解决方案**：
- 检查权限范围是否包含 `workflows:read`
- 确认账户下有可访问的工作流
- 验证Client Secret是否正确

## 📋 检查清单

在开始之前，请确认：
- [ ] 有Coze.com账户（国际版）
- [ ] 账户下有至少一个工作流
- [ ] Python环境已安装
- [ ] 端口8080可用
- [ ] 网络可以访问coze.com

## 🔗 相关文件

- `OAuth应用创建指南.md` - 详细的创建步骤
- `oauth_test_tool.py` - OAuth配置测试工具
- `coze_oauth_integration.py` - 集成模块
- `coze_connectivity_test_plugin.py` - 连通性测试插件

## 💡 下一步

配置成功后，您可以：
1. 在coze.cn插件中集成OAuth认证
2. 调用coze.com的工作流API
3. 实现跨平台的AI工作流集成

---

**需要帮助？** 请查看详细的 `OAuth应用创建指南.md` 或运行测试工具进行诊断。